import{T as q}from"./index-740445f5.js";import{D as R}from"./index-419b2a1f.js";import{C as O}from"./index-5b63b34b.js";import{I as U}from"./index-8bd2886e.js";import{I as j}from"./index-fc53d512.js";import{P as A}from"./index-6aa0e54f.js";import{B as F}from"./index-e5b31831.js";import{M as I}from"./Modal-b6922669.js";import{T as k}from"./index-97d86235.js";import{T as G}from"./index-7d062691.js";import{S as z}from"./index-d0b39234.js";import{c as C,a as p,b as M}from"./array-32517c55.js";import{_ as D,u as V,A as L,f as _,r as i,o as d,a as h,g as n,w as m,d as s,c as Q,l as N,h as H,t as b,e as u,j as J,p as K,q as W}from"./index-583483ef.js";import{B as X}from"./index-b9550106.js";import{b as Y}from"./menu-ec6df042.js";import"./utils-54aeb6c8.js";import"./vue-cleave.min-92d6160a.js";import"./transition-8fa849a3.js";import"./focus-management-d710945a.js";import"./keyboard-10a19c7f.js";import"./use-outside-click-7f7a0170.js";import"./hidden-edfc4318.js";import"./micro-task-89dcd6af.js";import"./open-closed-1f291b1c.js";import"./use-resolve-button-type-ead5bebf.js";const Z={data(){return{form:{name_fr:"",name_en:"",parent_category_id:0,desc:""},nameFRError:"",nameENError:"",parentError:"",descError:"",toast:V(),router:L(),formOptions:[],storing:!1}},components:{Modal:I,Button:F,Textinput:k,Select:z,Textarea:G},props:{formMode:{type:String,required:!0},user:{type:Object,required:!0,default:[]},loadData:{type:Function,required:!0}},methods:{validator(){C({name:p().required("Name is required")}).validate({name:this.form.name})},async FetchData(){await _.get("/api/admin/categories/id-name",{withCredentials:!0}).then(t=>{this.formOptions=t.data.categories}).catch(t=>{this.toast.error("Failed to fetch categories",{timeout:2e3}),console.log(t)})},loadEditData(t){this.form.id=t.id,this.form.name_fr=t.name_fr,this.form.name_en=t.name_en,this.form.parent_category_id=t.parent_category_id,this.form.desc=t.desc,console.log("Item:",t,`
Form:`,this.form)},resetForm(){this.form.name_fr="",this.form.name_en="",this.form.parent_category_id="",this.form.desc="",this.nameFRError="",this.nameENError="",this.parentError="",this.descError=""},createItem(){this.storing=!0,C({name_fr:p().required("French Name is required"),name_en:p().required("English Name is required"),parent_category_id:M().nullable(),desc:p().nullable()}).validate({name_fr:this.form.name_fr,name_en:this.form.name_en,parent_category_id:this.form.parent_category_id,desc:this.form.desc}).then(()=>{_.post("/api/admin/category/create",this.form,{withCredentials:!0}).then(e=>{this.$refs.modal1.closeModal(),this.toast.success("Registered successfully",{timeout:2e3}),this.resetForm(),this.loadData(),this.storing=!1}).catch(e=>{const a=e.response.data.errors;a.hasOwnProperty("name")&&(this.nameError=a.name[0]),a.hasOwnProperty("parent_category_id")&&(this.parentError=a.parent_category_id[0]),a.hasOwnProperty("desc")&&(this.descError=a.desc[0]),this.toast.error(e.message,{timeout:6e3}),this.storing=!1})}).catch(e=>{e.path==="name"?this.nameError=e.errors[0]:e.path==="parent_category_id"?this.parentError=e.errors[0]:e.path==="desc"&&(this.descError=e.errors[0]),this.storing=!1})},updateItem(){this.storing=!0,C({name_fr:p().required("French Name is required"),name_en:p().required("English Name is required"),parent_category_id:M().nullable(),desc:p().nullable()}).validate({name_fr:this.form.name_fr,name_en:this.form.name_en,parent_category_id:this.form.parent_category_id,desc:this.form.desc}).then(()=>{_.put(`/api/admin/category/update/${this.form.id}`,this.form).then(e=>{this.$refs.modal1.closeModal(),this.toast.success("Registered successfully",{timeout:2e3}),this.resetForm(),this.loadData(),this.storing=!1}).catch(e=>{const a=e.response.data.errors;a.hasOwnProperty("name_fr")&&(this.nameFRError=a.name_fr[0]),a.hasOwnProperty("name_en")&&(this.nameENError=a.name_en[0]),a.hasOwnProperty("parent_category_id")&&(this.parentError=a.parent_category_id[0]),a.hasOwnProperty("desc")&&(this.descError=a.desc[0]),this.toast.error(e.message,{timeout:6e3}),this.storing=!1})}).catch(e=>{e.path==="name_fr"?this.nameFRError=e.errors[0]:e.path==="name_en"?this.nameENError=e.errors[0]:e.path==="parent_category_id"?this.parentError=e.errors[0]:e.path==="desc"&&(this.descError=e.errors[0]),this.storing=!1})}},mounted(){this.FetchData()}},$={class:"modal-groups"},ee={class:"py-3 flex justify-end space-x-3 border-t border-slate-100 dark:border-slate-700"},te={key:1,type:"button",class:"px-3 py-2 bg-blue-600 flex items-center gap-2 rounded"},re=s("div",{class:"flex flex-row space-x-4"},[s("div",{class:"w-4 h-4 rounded-full animate-spin border-2 border-dashed border-white border-t-transparent"})],-1);function oe(t,e,a,P,r,l){const f=i("Textinput"),x=i("Select"),w=i("Textarea"),v=i("Button"),g=i("Modal");return d(),h("div",$,[n(g,{showLabel:!1,title:a.formMode==="create"?"Create New Category":"Update Category",label:"Create User",labelClass:"btn-outline-primary h-10 flex items-center",ref:"modal1",themeClass:"bg-primary-500"},{default:m(()=>[s("form",{onSubmit:e[4]||(e[4]=H(c=>a.formMode==="create"?l.createItem():l.updateItem(),["prevent"])),class:"text-base text-slate-600 dark:text-slate-300"},[n(f,{label:"Name in French",type:"text",placeholder:"Enter the name in French",name:"name",modelValue:r.form.name_fr,"onUpdate:modelValue":e[0]||(e[0]=c=>r.form.name_fr=c),error:r.nameFRError,classInput:"h-[48px] mb-3"},null,8,["modelValue","error"]),n(f,{label:"Name in English",type:"text",placeholder:"Enter the name in English",name:"name",modelValue:r.form.name_en,"onUpdate:modelValue":e[1]||(e[1]=c=>r.form.name_en=c),error:r.nameENError,classInput:"h-[48px] mb-3"},null,8,["modelValue","error"]),n(x,{modelValue:r.form.parent_category_id,"onUpdate:modelValue":e[2]||(e[2]=c=>r.form.parent_category_id=c),error:r.parentError,options:r.formOptions,label:"Parent Category",placeholder:"Select parent category",classInput:"h-[48px] mb-3"},null,8,["modelValue","error","options"]),n(w,{label:"Description",placeholder:"Description of the category",modelValue:r.form.desc,"onUpdate:modelValue":e[3]||(e[3]=c=>r.form.desc=c),error:r.descError,hasicon:"",classInput:"min-h-[48px]"},null,8,["modelValue","error"]),s("div",ee,[r.storing?(d(),h("button",te,[re,N(" Saving ")])):(d(),Q(v,{key:0,type:"submit",text:"Save",btnClass:"btn-primary h-10 flex items-center"}))])],32)]),_:1},8,["title"])])}const ae=D(Z,[["render",oe]]);const se={components:{Pagination:A,InputGroup:j,Dropdown:R,Icon:U,Card:O,MenuItem:Y,Modal:I,Button:F,Textinput:k,FormModal:ae,Tooltip:q,Breadcrumb:X},data(){return{categories:[],toast:V(),formMode:"create",form:{name:"",email:"",role:"",phone_number:"",password:""},item:[],current:1,perpage:10,pageRange:1,total:0,searchTerm:"",actions:[{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}],options:[{value:"1",label:"1"},{value:"3",label:"3"},{value:"5",label:"5"}],columns:[{label:"Id",field:"id"},{label:"Name",field:"name"},{label:"No. Products",field:"products_count"},{label:"Date",field:"created_at"},{label:"Action",field:"action"}]}},methods:{async FetchData(t=1){await _.get(`/api/admin/categories?page=${t}`,{withCredentials:!0}).then(e=>{this.categories=e.data.categories.data,this.total=e.data.categories.total,this.perpage=e.data.categories.per_page,this.current=e.data.categories.current_page}).catch(e=>{this.toast.error("Failed to fetch categories",{timeout:2e3})})},changePage(t){this.FetchData(t)},showCreateModal(){this.formMode="create",this.$refs.formModal1.resetForm(),this.$refs.formModal1.$refs.modal1.openModal()},showEditModal(t){this.formMode="edit",this.$refs.formModal1.resetForm(),this.item=t,this.$refs.formModal1.loadEditData(t),this.$refs.formModal1.$refs.modal1.openModal()},formatDate(t){const e=new Date(t),a={day:"2-digit",month:"short",year:"numeric"};return e.toLocaleDateString("en-US",a)},confirmDelete(t){confirm("Are you sure you want to delete this item?")&&this.deleteItem(t)},async deleteItem(t){await _.delete(`/api/admin/category/delete/${t}`,{withCredentials:!0}).then(e=>{this.FetchData(),this.toast.success("Category has been deleted successfully",{timeout:2e3})}).catch(e=>{this.toast.error("Failed to delete Category",{timeout:2e3})})}},mounted(){this.FetchData()}},E=t=>(K("data-v-2a079c2c"),t=t(),W(),t),ne={class:""},ie={class:"flex justify-between flex-wrap items-start"},ce={class:"modal-groups"},le={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},me=E(()=>s("h5",null,"Categories",-1)),de={key:0,class:"flex"},he={class:"w-7 h-7 rounded-full ltr:mr-3 rtl:ml-3 flex-none"},pe=["src","alt"],ue={class:"text-sm text-slate-600 dark:text-slate-300 capitalize"},_e={key:1},fe={key:2,class:"text-slate-500 dark:text-slate-300"},ge={key:3,class:"block w-full"},ye={key:4},be={class:"flex space-x-3 rtl:space-x-reverse"};const xe=["onClick"],we=E(()=>s("span",null," Edit",-1)),ve=["onClick"],Ce=E(()=>s("span",null,"Delete",-1)),Ee={class:"py-4 px-3"};function Me(t,e,a,P,r,l){const f=i("Breadcrumb"),x=i("FormModal"),w=i("Button"),v=i("InputGroup"),g=i("Icon"),c=i("Tooltip"),T=i("Pagination"),B=i("vue-good-table"),S=i("Card");return d(),h("div",ne,[s("div",ie,[n(f),s("div",ce,[n(x,{"load-data":l.FetchData,formMode:r.formMode,user:r.item,ref:"formModal1"},null,8,["load-data","formMode","user"]),n(w,{onClick:e[0]||(e[0]=o=>l.showCreateModal()),type:"submit",text:"Create Category",btnClass:"btn-primary h-10 flex items-center"})])]),s("div",null,[n(S,{noborder:""},{default:m(()=>[s("div",le,[me,n(v,{modelValue:r.searchTerm,"onUpdate:modelValue":e[1]||(e[1]=o=>r.searchTerm=o),placeholder:"Search",type:"text",prependIcon:"heroicons-outline:search",merged:""},null,8,["modelValue"])]),n(B,{columns:r.columns,styleClass:"vgt-table bordered centered",rows:r.categories,"pagination-options":{enabled:!0,perPage:r.perpage},"search-options":{enabled:!0,externalQuery:r.searchTerm}},{"table-row":m(o=>[o.column.field=="customer"?(d(),h("span",de,[s("span",he,[s("img",{src:o.row.customer.image,alt:o.row.customer.name,class:"object-cover w-full h-full rounded-full"},null,8,pe)]),s("span",ue,b(o.row.customer.name),1)])):u("",!0),o.column.field=="order"?(d(),h("span",_e,b("#"+o.row.order),1)):u("",!0),o.column.field=="created_at"?(d(),h("span",fe,b(l.formatDate(o.row.created_at)),1)):u("",!0),o.column.field=="is_active"?(d(),h("span",ge,[s("span",{class:J(["inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] bg-opacity-25",`${o.row.is_active===1?"text-success-500 bg-success-500":""} 
              ${o.row.is_active==="due"?"text-warning-500 bg-warning-500":""}
              ${o.row.is_active===0?"text-danger-500 bg-danger-500":""}
              
                `])},b(o.row.is_active==1?"Activated":"Deactivated"),3)])):u("",!0),o.column.field=="action"?(d(),h("span",ye,[s("div",be,[u("",!0),n(c,{placement:"top",arrow:"",theme:"dark"},{button:m(()=>[s("div",{onClick:y=>l.showEditModal(o.row),class:"action-btn"},[n(g,{icon:"heroicons:pencil-square"})],8,xe)]),default:m(()=>[we]),_:2},1024),n(c,{placement:"top",arrow:"",theme:"danger-500"},{button:m(()=>[s("div",{onClick:y=>l.confirmDelete(o.row.id),class:"action-btn"},[n(g,{icon:"heroicons:trash"})],8,ve)]),default:m(()=>[Ce]),_:2},1024)])])):u("",!0)]),"pagination-bottom":m(o=>[s("div",Ee,[n(T,{total:r.total,current:r.current,"per-page":r.perpage,pageRange:r.pageRange,onPageChanged:e[2]||(e[2]=y=>{r.current=y,l.changePage(y)}),pageChanged:o.pageChanged,perPageChanged:o.perPageChanged,enableSearch:"",options:r.options},{default:m(()=>[N(" > ")]),_:2},1032,["total","current","per-page","pageRange","pageChanged","perPageChanged","options"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1})])])}const Ye=D(se,[["render",Me],["__scopeId","data-v-2a079c2c"]]);export{Ye as default};
