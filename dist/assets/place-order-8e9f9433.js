import{M as y,H as b,F as I,P as S}from"./index-dab3cfdb.js";import{C}from"./index-fdbdfb57.js";import{_ as V,f as u,a as c,g as n,d as t,w,F,b as O,t as d,i as q,e as k,r as p,o as m,p as N,m as T,k as A}from"./index-47c70d24.js";import{B as j}from"./index-c825509e.js";import{T as B}from"./index-253d4462.js";import{S as H}from"./index-594d5b9d.js";import{I as P}from"./index-61dc0fab.js";import{c as J}from"./checkAuth-7fdecac9.js";import"./transition-446dcf16.js";import"./focus-management-11ee4cc9.js";import"./keyboard-18b04f11.js";import"./use-outside-click-1f63f6e1.js";import"./hidden-6a76d261.js";import"./micro-task-89dcd6af.js";import"./open-closed-dd2cd86f.js";import"./vue-cleave.min-2c4d7fec.js";const U={data(){return{apiUrl:u,cartItems:[],products:[],loading:!1,total:0,delivery:2500,cart:JSON.parse(localStorage.getItem("cart")),detailAddressSaved:!1,form:{ville:"",quartier:""},locationOptions:[],locations:[]}},components:{Modal:y,Button:j,Header:b,Footer:I,ProductCart:S,Icon:P,TextInput:B,Select:H,Card:C},methods:{async getCartItems(){let e=JSON.parse(localStorage.getItem("cart"));if(!e){e=[];return}for(let s=e.length-1;s>=0;s--)typeof e[s]!="object"&&e.splice(s,1);console.log(e),e.length>0&&await u.post("api/cart/items",{productVariantIds:e}).then(s=>{let r=s.data.products;for(let a=0;a<r.length;a++)r[a].quantity=e.find(o=>o.productVariantId==r[a].id).quantity,this.total+=r[a].price*r[a].quantity;this.cartItems=r}).catch(s=>{console.log(s)})},getLocations(){u.get("api/delivery-locations").then(e=>{this.locationOptions=e.data.locations.map(s=>({value:s.id,label:s.name})),this.locations=e.data.locations}).catch(e=>{console.log(e)})},async placeOrder(){if(!J()){this.$router.push("/login");return}if(!this.form.ville||!this.form.quartier){this.toast.error("Please fill in the address fields",{timeout:2e3});return}let e=JSON.parse(localStorage.getItem("cart")),s=[];for(let r=0;r<e.length;r++)s.push(e[r].productVariantId);await u.post("api/orders",{productVariantIds:s,ville:this.form.ville,quartier:this.form.quartier}).then(r=>{this.toast.success("Order placed successfully",{timeout:2e3}),localStorage.removeItem("cart"),this.$router.push("/orders")}).catch(r=>{this.toast.error("Failed to place order",{timeout:2e3})})}},async mounted(){this.getCartItems()}},i=e=>(N("data-v-c9b27980"),e=e(),T(),e),D={key:0,class:"bg-white"},L={key:0,class:"px-2 md:px-10 min-h-80 py-10 grid grid-cols-12 gap-6"},M=i(()=>t("div",{class:"col-span-full"},[t("h1",{class:"text-2xl font-bold text-center"},"Shopping Cart")],-1)),z={class:"col-span-full md:col-span-7"},E={class:"pb-6 md:space-y-0 space-y-3 items-center"},G=i(()=>t("h5",{class:"text-start mb-3"},"Shopping Address",-1)),Q={class:"grid grid-cols-12 gap-6"},K={class:"col-span-full sm:col-span-6"},R={class:"col-span-full sm:col-span-6"},W={class:"h-full col-span-full md:col-span-5 gap-2 flex bg-white"},X={class:"min-w-full flex flex-col gap-3 ml-auto border p-2 font-medium"},Y=i(()=>t("h3",{class:"text-lg"}," Order Summary",-1)),Z={class:"border-b pb-2"},$={class:"grid grid-cols-12 items-center justify-between py-1"},tt={class:"col-span-2 text-sm text-start"},et={class:"col-span-7 text-sm text-start"},st={class:"col-span-3 text-sm text-end"},ot={class:"grid grid-cols-12 items-center justify-between py-1"},rt=i(()=>t("div",{class:"col-span-9 text-sm text-start"},"Delivery",-1)),lt={class:"col-span-3 text-sm text-end"},at={class:"grid grid-cols-12 items-center justify-between py-1"},it=i(()=>t("div",{class:"col-span-9 text-sm text-start"},"Total",-1)),ct={class:"col-span-3 text-sm text-end"},nt={class:"col-span-full"},dt={key:1,class:"col-span-full px-2 md:px-10 min-h-80 py-10 flex flex-col justify-between"},pt=i(()=>t("div",{class:"w-full pb-5"},[t("h1",{class:"text-2xl font-bold text-center"},"Shopping Cart")],-1)),mt=i(()=>t("p",{class:"text-lg font-medium text-slate-500 text-center"},[A("No products in cart. "),t("a",{href:"/",class:"underline"},"Go shopping")],-1)),ut=[pt,mt];function _t(e,s,r,a,o,_){const h=p("Header"),f=p("Select"),g=p("TextInput"),x=p("Card"),v=p("Footer");return o.loading?k("",!0):(m(),c("div",D,[n(h),o.cartItems&&o.cartItems.length>0?(m(),c("div",L,[M,t("div",z,[n(x,{noborder:""},{default:w(()=>[t("div",E,[G,t("div",Q,[t("div",K,[n(f,{modelValue:o.form.ville,"onUpdate:modelValue":s[0]||(s[0]=l=>o.form.ville=l),placeholder:"Ville",options:o.locationOptions},null,8,["modelValue","options"])]),t("div",R,[n(g,{modelValue:o.form.quartier,"onUpdate:modelValue":s[1]||(s[1]=l=>o.form.quartier=l),placeholder:"Quartier"},null,8,["modelValue"])])])])]),_:1})]),t("div",W,[t("div",X,[Y,t("div",Z,[(m(!0),c(F,null,O(o.cartItems,l=>(m(),c("div",$,[t("div",tt,d(l.quantity),1),t("div",et,d(l.title),1),t("div",st,d(l.price*l.quantity+"FCFA"),1)]))),256))]),t("div",ot,[rt,t("div",lt,d(o.delivery+"FCFA"),1)]),t("div",at,[it,t("div",ct,d(o.total+o.delivery+"FCFA"),1)]),t("div",nt,[t("button",{onClick:s[2]||(s[2]=l=>o.cart.length>0?_.placeOrder():""),class:q([{"pointer-events-none":o.cart.length<=0,"pointer-events-auto":o.cart.length>0},"text-center w-full mt-10 font-medium text-base text-white bg-[#0e0e0e] py-3 rounded"])}," Proceed to Checkout ",2)])])])])):(m(),c("div",dt,ut)),n(v)]))}const Nt=V(U,[["render",_t],["__scopeId","data-v-c9b27980"]]);export{Nt as default};
